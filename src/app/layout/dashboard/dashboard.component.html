<div
  class="row"
  *ngIf="{
    dt: data.dt$ | async,
    allIndices: data.allIndices$ | async
  } as _data"
>
  <div class="col-md-6 col-lg-6" *ngIf="_data.allIndices != null">
    <select
      class="form-select form-select-sm"
      aria-label=".form-select-sm example"
      [(ngModel)]="data.selected"
      (change)="h_selected_change(data)"
    >
      <option selected>--Selete--</option>
      <option [value]="i.index" *ngFor="let i of ob(_data.allIndices).data">
        {{ i.index }}
      </option>
    </select>
  </div>

  <div class="col-md-6 col-lg-6">
    <button
      type="button"
      id="h_selected_change"
      class="btn btn-sm btn-danger me-2"
      (click)="h_selected_change(data)"
    >
      <i class="fa-solid fa-arrows-rotate"></i>
    </button>
  </div>
  <div class="col-12">
    <div id="container"></div>
  </div>
  <div class="col-12" *ngIf="_data.allIndices !== null">
    <table
      class="table table-sm table-striped table-hover mt-2"
      id="dashboard_component_tbl1"
    >
      <thead class="header-fixed bg">
        <tr>
          <th>ID</th>
          <th>
            index {{ ob(_data.allIndices).timestamp }}
            <span
              id="ref_index"
              (click)="ref_index()"
              class="fa-solid fa-arrows-rotate"
            ></span>
          </th>
          <th>adv</th>
          <th>dec</th>
          <th>pe</th>
          <!-- <th>pb</th> -->
          <th>Change%</th>
          <th>YL</th>
          <th>last</th>
          <th>YH</th>
          <th>Today</th>
          <th>30D</th>
          <th>365D</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let i of ob(_data.allIndices).data">
          <!--          (click)="goto(i)"-->
          <td class="p-2">{{ i.id + 1 }}</td>
          <td
            class="p-2"
            [class]="{
              'text-danger': i.open > i.last,
              'text-success': i.open < i.last
            }"
          >
            <!--            <a [routerLink]="['/index?symbol=', i.index]">-->
            <a [routerLink]="['/index']" [queryParams]="{ symbol: i.index }">
              {{ i.index }}
            </a>
          </td>
          <td class="p-2">
            {{ i.advances || 0 }}
          </td>
          <td class="p-2">
            {{ i.declines || 0 }}
          </td>
          <td class="p-2">{{ i.pe }}</td>
          <!-- <td>{{ i.pb }}</td> -->

          <td class="p-2">{{ i.percentChange }}</td>
          <td class="p-2">{{ n(i.yearLow) }}</td>
          <td class="p-2">{{ n(i.last) }}</td>
          <td class="p-2">{{ n(i.yearHigh) }}</td>

          <td>
            <img [src]="i.chartTodayPath" [title]="i.percentChange" />
            <span class="d-none">{{ i.percentChange }}</span>
          </td>
          <td>
            <img [src]="i.chart30dPath" [title]="i.perChange30d" />
            <span class="d-none">{{ i.perChange30d }}</span>
          </td>
          <td>
            <img [src]="i.chart365dPath" [title]="i.perChange365d" />
            <span class="d-none">{{ i.perChange365d }}</span>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
<!--
{
    "key": "BROAD MARKET INDICES",
    "index": "NIFTY 50",
    "indexSymbol": "NIFTY 50",
    "last": 17770.9,
    "variation": -85.6,
    "percentChange": -0.48,
    "open": 17859.1,
    "high": 17880.7,
    "low": 17719.75,
    "previousClose": 17856.5,
    "yearHigh": 18887.6,
    "yearLow": 15183.4,
    "pe": "21.05",
    "pb": "4.16",
    "dy": "1.42",
    "declines": "34",
    "advances": "16",
    "unchanged": "0",
    "perChange365d": 2.77,
    "date365dAgo": "11-Feb-2022",
    "chart365dPath": "https://static.nseindia.com/sparklines/365d/NIFTY-50.jpg",
    "date30dAgo": "13-Jan-2023",
    "perChange30d": -0.56,
    "chart30dPath": "https://static.nseindia.com/sparklines/30d/NIFTY-50.jpg",
    "chartTodayPath": "https://static.nseindia.com/sparklines/today/NIFTY-50.jpg",
    "previousDay": 17893.45,
    "oneWeekAgo": 17764.6,
    "oneMonthAgo": 17956.6,
    "oneYearAgo": 17374.75
}-->
<!--
chart30dPath
:
"https://static.nseindia.com/sparklines/30d/NIFTY-50.jpg"
chart365dPath
:
"https://static.nseindia.com/sparklines/365d/NIFTY-50.jpg"
chartTodayPath
:
"https://static.nseindia.com/sparklines/today/NIFTY-50.jpg"
-->
